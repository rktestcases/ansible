---
- hosts: localhost
  connection: local
  gather_facts: False
  tasks:
    - name: Import vpc vars
      include_vars: var/vars

    - name: create a vpc
      ec2_vpc_net:
         name: "{{vpc_name}}"
         cidr_block: "{{vpccidr}}"
         region: "{{region}}"
         dns_support: yes
         dns_hostnames: yes
         tenancy: default
         state: "{{state}}"
         tags:
            Name: vprofilevpc
      register: vpc_out

    - name: create a public_subnet
      ec2_vpc_subnet:
        vpc_id: "{{ vpc_out.vpc.id }}"
        region: "{{ region }}"
        az: "{{ zone }}"
        state: "{{ state }}"
        cidr: "{{ pubsubnet }}"
        map_public: yes
        tags:
          Name: pubsub
      register: pubsubout


